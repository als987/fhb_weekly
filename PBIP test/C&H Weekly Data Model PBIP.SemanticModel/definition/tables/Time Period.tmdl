table 'Time Period'
	lineageTag: 60bd58db-43e7-417f-a01c-39c1f5856f97

	column Date
		formatString: General Date
		lineageTag: 655814f8-6e87-486f-8051-e01652f62e4a
		summarizeBy: none
		isNameInferred
		sourceColumn: [Date]

		annotation SummarizationSetBy = Automatic

	column 'Time Period'
		lineageTag: bfbec31d-bbf6-4934-ad0e-fc17b8910ba9
		summarizeBy: none
		isNameInferred
		sourceColumn: [Time Period]
		sortByColumn: Order

		changedProperty = SortByColumn

		annotation SummarizationSetBy = Automatic

	column 'Axis Date'
		formatString: General Date
		lineageTag: 68080a73-3d58-4681-bf36-b97b42ca3a3d
		summarizeBy: none
		isNameInferred
		sourceColumn: [Axis Date]

		annotation SummarizationSetBy = Automatic

	column Order
		formatString: 0
		lineageTag: 8c3c1563-a88c-4b72-831b-e435aa16b45f
		summarizeBy: sum
		isNameInferred
		sourceColumn: [Order]

		annotation SummarizationSetBy = Automatic

	partition 'Time Period-84a9319a-4630-4923-ad15-969057525727' = calculated
		mode: import
		source =
				
				VAR _LatestActuals =
				    CALCULATE (
				        MAX ( statsLatestData[latestFiscalWeekEndingDate] ),
				        statsLatestData[dataSource] = "Sales Dispatch"
				    )
				VAR _ThisYear =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalYear] ),
				        RefCalendar[fiscalWeekEndingDate] = _LatestActuals
				    )
				VAR _FirstWeekThisYear =
				    CALCULATE (
				        MIN ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[fiscalYear] = _ThisYear
				    )
				VAR _LatestWeekNo =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekNumber] ),
				        RefCalendar[fiscalWeekEndingDate] = _LatestActuals
				    )
				VAR _CalendarStart =
				    MIN ( RefCalendar[fiscalWeekEndingDate] )
				VAR _CalendarEnd =
				    MAX ( RefCalendar[fiscalWeekEndingDate] )
				VAR _ThisFiscalPeriod =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalMonth] ),
				        RefCalendar[fiscalWeekEndingDate] = _LatestActuals
				    )
				VAR _ThisFiscalQuarter =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalQuarter] ),
				        RefCalendar[fiscalWeekEndingDate] = _LatestActuals
				    )
				VAR _ThisMonthStart =
				    CALCULATE (
				        MIN ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[fiscalMonth] = _ThisFiscalPeriod
				    )
				VAR _ThisMonthEnd =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[fiscalMonth] = _ThisFiscalPeriod
				    )
				VAR _ThisQuarterStart =
				    CALCULATE (
				        MIN ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[fiscalQuarter] = _ThisFiscalQuarter
				    )
				VAR _ThisQuarterEnd =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[fiscalQuarter] = _ThisFiscalQuarter
				    )
				VAR _ThisIndex =
				    CALCULATE (
				        MAX ( RefCalendar[Index] ),
				        RefCalendar[fiscalWeekEndingDate] = _LatestActuals
				    )
				VAR _4WeeksBack =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex - 4)
				    )
				VAR _4WeeksForward =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex + 4)
				    )
				VAR _6WeeksBack =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex - 6)
				    )
				VAR _6WeeksForward =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex + 6)
				    )
				VAR _8WeeksBack =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex - 8)
				    )
				VAR _8WeeksForward =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex + 8)
				    )
				VAR _13WeeksBack =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex - 13)
				    )
				VAR _13WeeksForward =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex + 13)
				    )
				VAR _26WeeksBack =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex - 26)
				    )
				VAR _52WeeksBack =
				    CALCULATE (
				        MAX ( RefCalendar[fiscalWeekEndingDate] ),
				        RefCalendar[Index] = (_ThisIndex - 52)
				    )
				RETURN
				    SELECTCOLUMNS (
				        UNION (
				            // This Week
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "This Week" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _LatestActuals, _LatestActuals )
				                ),
				                "Axis Date", [Value],
				                "Order", 1
				            ),
				            // Month to Date
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "MTD" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _ThisMonthStart, _LatestActuals )
				                ),
				                "Axis Date", [Value],
				                "Order", 2
				            ),
				            // Month to Go
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "MTG" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _LatestActuals + 7, _ThisMonthEnd )
				                ),
				                "Axis Date", [Value],
				                "Order", 3
				            ),
				            // Full Month
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "Full Month" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _ThisMonthStart, _ThisMonthEnd )
				                ),
				                "Axis Date", [Value],
				                "Order", 4
				            ),
				            // Quarter to Date
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "QTD" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _ThisQuarterStart, _LatestActuals )
				                ),
				                "Axis Date", [Value],
				                "Order", 5
				            ),
				            // Quarter to Go
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "QTG" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _LatestActuals + 7, _ThisQuarterEnd )
				                ),
				                "Axis Date", [Value],
				                "Order", 6
				            ),
				            // YTD
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "YTD" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _FirstWeekThisYear, _LatestActuals )
				                ),
				                "Axis Date", [Value],
				                "Order", 7
				            ),
				            // Last 26 weeks
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "Last 26 weeks" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _26WeeksBack, _LatestActuals )
				                ),
				                "Axis Date", [Value],
				                "Order", 8
				            ),
				            // Last 13 weeks
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "Last 13 weeks" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _13WeeksBack, _LatestActuals )
				                ),
				                "Axis Date", [Value],
				                "Order", 9
				            ),
				            // 4 back 4 forward
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "4 back 4 forward" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _4WeeksBack, _4WeeksForward )
				                ),
				                "Axis Date", [Value],
				                "Order", 10
				            ),
				            // 6 back 6 forward
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "6 back 6 forward" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _6WeeksBack, _6WeeksForward )
				                ),
				                "Axis Date", [Value],
				                "Order", 11
				            ),
				            // 8 back 8 forward
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "8 back 8 forward" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _8WeeksBack, _8WeeksForward )
				                ),
				                "Axis Date", [Value],
				                "Order", 12
				            ),
				            // 13 back 13 forward
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "13 back 13 forward" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _13WeeksBack, _13WeeksForward )
				                ),
				                "Axis Date", [Value],
				                "Order", 13
				            ),
				            // Full Quarter
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "Full Quarter" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _ThisQuarterStart, _ThisQuarterEnd )
				                ),
				                "Axis Date", [Value],
				                "Order", 14
				            ),
				            // Last 52 weeks
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "Last 52 weeks" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _52WeeksBack, _LatestActuals )
				                ),
				                "Axis Date", [Value],
				                "Order", 15
				            ),
				            // Pre-current quarter
				            ADDCOLUMNS (
				                GENERATE (
				                    SELECTCOLUMNS ( { "Pre-current quarter" }, "Time Period", [Value] ),
				                    GENERATESERIES ( _CalendarStart, _ThisQuarterStart - 7 )
				                ),
				                "Axis Date", [Value],
				                "Order", 16
				            )
				        ),
				        "Date", [Value],
				        "Time Period", [Time Period],
				        "Axis Date", [Axis Date],
				        "Order", [Order]
				    )

	annotation PBI_Id = 02086b0c33014e878b3ccfc16aafeafa

